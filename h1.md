# Hacker Warmup _by Saku Laitinen_

## Sisällysluettelo

- **[Johdanto](https://github.com/KebabGarva/Tunkeutumistestaus2024-bgu248/blob/main/h1.md#Johdanto)**
- **[Lämmittelytehtävä](https://github.com/KebabGarva/Tunkeutumistestaus2024-bgu248/blob/main/h1.md#Lämmittelytehtävä)**
- **[Over The Wire Bandit -peli](https://github.com/KebabGarva/Tunkeutumistestaus2024-bgu248/blob/main/h1.md#Over-The-Wire-Bandit--peli)**
- **[WebGoatin tehtävät](https://github.com/KebabGarva/Tunkeutumistestaus2024-bgu248/blob/main/h1.md#WebGoatin-tehtävät)**
- **[SQL-injektioharjoitus](https://github.com/KebabGarva/Tunkeutumistestaus2024-bgu248/blob/main/h1.md#SQL-injektioharjoitus)**
- **[Linuxin asennus VirtualBoxiin ja Vagrantiin liittäminen](https://github.com/KebabGarva/Tunkeutumistestaus2024-bgu248/blob/main/h1.md#Linuxin-asennus-Virtualboxiin-ja-Vagrantiin-liittäminen)**
- **[Noin 1000 TCP-porttia skannattavaksi](https://github.com/KebabGarva/Tunkeutumistestaus2024-bgu248/main/h1.md#Noin-1000-TCP-porttia-skannattavaksi)**
- **[Kaikkien TCP-porttien skannaus](https://github.com/KebabGarva/Tunkeutumistestaus2024-bgu248/blob/main/h1.md#Kaikkien-TCP-porttien-skannaus)**
- **[Laaja porttiskannaus](https://github.com/KebabGarva/Tunkeutumistestaus2024-bgu248/blob/main/h1.md#Laaja-porttiskannaus)**
- **[Porttiskannauksien tuloksien ero eri daemonien olevan aktiivisia](https://github.com/KebabGarva/Tunkeutumistestaus2024-bgu248/blob/main/h1.md#Idempotenssi-ja-sen-konkreettiset-esimerkit)**
- **[Shodan](https://github.com/KebabGarva/Tunkeutumistestaus2024-bgu248/blob/main/h1.md#Shodan)**
- **[Lisätehtävien tekemistä](https://github.com/KebabGarva/Tunkeutumistestaus2024-bgu248/blob/main/h1.md#Lisätehtävien-tekemistä)**
- **[Lähteet lämmittelytehtävästä eteenpäin](https://github.com/KebabGarva/Tunkeutumistestaus2024-bgu248/blob/main/h1.md#Lähteet-lämmittelytehtävästä-eteenpäin)**

## Johdanto

### Mitä?

Tämä raportti on tehty Tero Karvisen toteuttaman kurssin [Tunkeutumistestaus](https://terokarvinen.com/2024/eettinen-hakkerointi-2024/) yhteydessä. Tämä raportti kertoo läpikohtaisesti, mitä tein tehtävän h1 eteen.
Sisällysluettelon linkkejä painamalla pystyy navigoimaan suoraan haluttuun kohtaan.

### Missä?

Toteutin tehtäviin liittyvät komennot fyysisessä Windows 11 - ja virtuaalisissa Kali-ympäristöissä hyödyntämällä [Virtualboxia](https://www.virtualbox.org/) ja [Vagrantia](https://developer.hashicorp.com/vagrant).
Spesifoin tarkemmin kappaleen alussa, mitkä ovat käytettävän/käytettävien käyttöjärjestelmien tiedot. Kaikki komennot ovat toteutettu Linux-virtuaaliympäristössä lukuunottamatta mahdollisia Vagrant -komentoja fyysisessä ympäristössä.

**Tietokoneet**

[*Fyysinen kone: Lenovo Legion 7 16ACHg6*](https://nanoreview.net/en/laptop/lenovo-legion-7-2021-amd?m=c.1_g.3_r.3_s.3)

### Milloin?

Testit suoritettiin 3.4. - 6.4. välillä. Lopullinen muotoilu ja oikoluku tehtiin 6.4.

## Lämmittelytehtävä

### Surveying Essential Tools for Active Reconnaissance.

- Aktiivinen tiedustelu on vaihe haavoittuvuuksien kartoittamisessa, jossa otetaan yhteys suoraan kohteeseen.
  - Yhteydenotto aiheuttaa hälytyksiä, jotka näkyvät systeemilokissa.

- Aktiivinen tiedustelu on esimerkiksi
  - Porttiskannausta
  - Verkkopalvelujen analysointia
  - Verkon haavoittuvuuden skannaamista

- Esimerkkejä yleisen verkkohaavoittuvuuden skannereista
  - [OpenVAS](https://www.openvas.org/)
  - [Nessus](https://www.tenable.com/products/nessus)
  - [Nmap](https://nmap.org/)
  
- Esimerkkejä verkkopalveluiden haavoittuvuuden skannereista
  - [Nikto](https://cirt.net/nikto2)
  - [WPScan](https://wpscan.com/)
  - [Burp Suite](https://portswigger.net/burp/communitydownload)

**Lähde:**

Sternstein, John & Santos, Omar: The Art of Hacking - Lesson 4: Active Reconnaissance, O'Reilly -verkkokurssin moduuli, huhtikuu 2019. https://learning.oreilly.com/course/the-art-of/9780135767849/. Viitattu 4.4.2024
  
### Kybertappoketju

- Lockheed Martinin asiakirjassa (Cloppert - Hitchins - Rohan 2011, 3.2) esitellään kybertappoketjua
- Sovellettu Yhdysvaltain asevoimien hyökkäysmallista
  - Muotoiltu eri tavalla kyberhyökkäyksien helpompaa hahmottamista varten
- Kybertappoketju jakaantuu seitsemään vaiheeseen:
  - Tiedustelu
  - Aseistus
  - Toimitus
  - Hyväksikäyttö
  - Asennus
  - Etäohjaus
  - Tehtävän toteuttaminen


**Lähde:**

Cloppert, Michael - Hutchins, Eric - Rohan, Amin: Intelligence-Driven Computer Network Defense
Informed by Analysis of Adversary Campaigns and
Intrusion Kill Chains. Asiakirja, Lockheed Martin -konserni. https://lockheedmartin.com/content/dam/lockheed-martin/rms/documents/cyber/LM-White-Paper-Intel-Driven-Defense.pdf. Viitattu 4.4.2024


## Over The Wire Bandit -peli

**Käyttöjärjestelmä: Kali 2024.1**

Latasin [Kalin verkkosivuilta](https://www.kali.org/get-kali/#kali-virtual-machines) valmiin virtuaalikoneen nopeuttaakseni tehtäväntekoprosessia. 

![image](https://github.com/KebabGarva/Tunkeutumistestaus2024-bgu248/assets/89390996/1369d018-e9ff-4405-be4b-e1b5e766086b)

Käynnistin virtuaalikoneen, ja suuntasin tekemään [Over The Wiren Bandit -tehtäviä](https://overthewire.org/wargames/bandit/). Kävin ensin vaihtamassa näppäimistön kielen englannista suomeksi. Se helpottaa tehtävää, kun fyysisen näppäimistön kieli on sama kuin käyttöjärjestelmän näppäimistön kieli. Poistin englannin myös valikosta, jotta Kali valitsee varmasti suomen kielen.

![image](https://github.com/KebabGarva/Tunkeutumistestaus2024-bgu248/assets/89390996/f1e2a94f-5e69-4030-9c8e-7d7e69ed9a0b)

<details>

<summary>Taso 0 ja yhdistäminen Taso 1:hteen</summary>

### SSH-yhteyden muodostaminen

Ensimmäisen tehtävän tavoitteena oli yhdistää pelin palvelimelle SSH-yhteydellä. Tehtävä oli varsin helppo, koska kirjautumistunnukset oli annettu valmiiksi.

![image](https://github.com/KebabGarva/Tunkeutumistestaus2024-bgu248/assets/89390996/ae6fccdd-a82e-4059-ab06-9b12405d1c62)

SSH-yhteys saatiin pelipalvelimelle seuraavalla komennolla:

```
ssh bandit.labs.overthewire.org -p 2220 -l bandit0
```
![image](https://github.com/KebabGarva/Tunkeutumistestaus2024-bgu248/assets/89390996/a09f11fb-973f-4906-aeaf-1adc9ac6df56)

Tässä vaiheessa tajusin, että uuden virtuaalikoneen lisäämisellä ei ollut lainkaan väliä, koska yhdistin kuitenkin ssh-yhteydellä toiseen koneeseen nähden ainoastaan komentokehotteen. Ja koska latasin nimenomaan sellaisen virtuaalikoneen, joka oli valmiiksi asennettu, joudun kuitenkin lataamaan joko Kalin tai Debianin levykuvasta.

![image](https://github.com/KebabGarva/Tunkeutumistestaus2024-bgu248/assets/89390996/249b48ac-2520-48ee-a024-76a2a6f696c9)

### Taso 0

Tehtävän tarkoitus on navigoida readme -kansioon, joka sisältää seuraavan tehtävän salasanan. Toteutin seuraavat komennot, jotta löydän kansion:

```
ls
sudo nano readme
nano readme

```

![image](https://github.com/KebabGarva/Tunkeutumistestaus2024-bgu248/assets/89390996/b6eda5b1-1f97-4e04-a36e-53813b2894eb)

Toinen komento oli jäänyt selkärankaan Linux -tehtävistä, joita olen tehnyt aikaisempien kurssien aikana. Tuntui vastenmieliseltä kirjoittaa `nano readme`. Opin myös äsken, että `cat`-komento tulostaa tiedoston suoraan komentolinjaan. 

![image](https://github.com/KebabGarva/Tunkeutumistestaus2024-bgu248/assets/89390996/28e040c7-413b-43e9-aad4-6021f75f1ea9)

Siirryin uuteen tehtävään seuraavilla komennoilla:

```
exit
ssh bandit.labs.overthewire.org -p 2220 -l bandit1
password: NH2SXQwcBdpmTEzi3bvBHMM9H66vVXjL
```
![image](https://github.com/KebabGarva/Tunkeutumistestaus2024-bgu248/assets/89390996/2929c008-c700-4ff4-b695-a2bfa70495ad)


</details>

<details>

<summary>Taso 2</summary>

### Taso 1

Tehtävä ohjeistaa avaamaan tiedoston "-" saadakseen salasanan seuraavaa tehtävää varten. Toteutin seuraavat komennot, jotta voin yhdistää seuraavalle koneelle.

```
cat '-'
cat ~/'-'
exit
ssh bandit.labs.overthewire.org -p 2220 -l bandit2
password: rRGizSaX8Mk1RTb1CNQoXTcYZWU6lgzi
```

![image](https://github.com/KebabGarva/Tunkeutumistestaus2024-bgu248/assets/89390996/3d495bb2-4265-46d0-8e96-08c7f8467fb3)

Huomasin heti tässä olevan joku kikka. Koska merkki "-" on asetuksia varten ja `cat`-komennolla voi spesifoida tarkemmin, minkä tiedoston haluaa avata. Selvitin myöhemmin, että komento ilman heittomerkkiä toimii myös. 

```
cat ~/-

```
![image](https://github.com/KebabGarva/Tunkeutumistestaus2024-bgu248/assets/89390996/ca8c458f-5e5a-46d2-bb35-cce82b77eda5)

Siirryin tämän jälkeen koneelle bandit2.

</details>

<details>

<summary>Taso 2</summary>

### Taso 2

Lähdin selvittämään, onnistuuko `ls`-komennon kautta kopioimaan tiedoston nimen, koska ymmärsin tiedoston olevan pelkästään välilyöntejä.

![image](https://github.com/KebabGarva/Tunkeutumistestaus2024-bgu248/assets/89390996/fb070e5c-0789-4f69-80be-ea00dc2a3829)


Tajusin tässä vaiheessa, että tiedoston nimi oli kirjaimellisesti "spaces in this filename". Tehtävä näytti helpottuneen huomattavasti. Ennen tehtävään siirtymistä virtuaalikoneeni kärsi hitaudesta, joten lisäsin välimuistia ainakin noin neljään gigaan.

![image](https://github.com/KebabGarva/Tunkeutumistestaus2024-bgu248/assets/89390996/90868a6d-fef9-4e43-9b89-11b7e8a0cd53)


Käynnistin koneen uudelleen ja suoritin seuraavat komennot:

```
cat "spaces in this filename"
exit
ssh bandit.labs.overthewire.org -p 2220 -l bandit3
password: aBZ0W5EmUfAf7kHTQeOwd8bauFJ2lAiG
```
![image](https://github.com/KebabGarva/Tunkeutumistestaus2024-bgu248/assets/89390996/a625ad95-61f2-4fb1-9f85-d244e2e3ece9)

Tehtävä oli huomattavasti helpompi kuin edellinen. En ymmärtänyt, miksi piti laittaa huomattavasti vaikea tehtävä alkuun.
</details>

## WebGoatin tehtävät

**Käyttöjärjestelmä: Kali 2024.1**

Latasin WebGoatin virtuaalikoneelleni [Tero Karvisen artikkelin](https://terokarvinen.com/2023/webgoat-2023-4-ethical-web-hacking/) ohjeiden mukaisesti. Toteutin seuraavat komennot lataakseni Javan, palomuurin ja WebGoatin. 

```
$ sudo apt-get update
$ sudo apt-get install openjdk-17-jre
$ sudo apt-get install ufw
$ sudo ufw enable
$ wget https://github.com/WebGoat/WebGoat/releases/download/v2023.4/webgoat-2023.4.jar
```
![image](https://github.com/KebabGarva/Tunkeutumistestaus2024-bgu248/assets/89390996/cd502990-53bb-4bbd-a0c3-0d7061110d17)

![image](https://github.com/KebabGarva/Tunkeutumistestaus2024-bgu248/assets/89390996/2cf39e09-d930-4bb1-9015-cfb1cca50d10)

![image](https://github.com/KebabGarva/Tunkeutumistestaus2024-bgu248/assets/89390996/5636965b-0f26-4728-9f59-18d5c7275d47)

Vaihdoin myös portin 8080:sta 8888:teen ohjeen mukaisesti, jotta voin tarvittaessa käyttää OWASP ZAP -ohjelmistoa seuraavalla komennolla:

```
$ java -Dfile.encoding=UTF-8 -Dwebgoat.port=8888 -Dwebwolf.port=9090 -jar webgoat-2023.4.jar
```
![image](https://github.com/KebabGarva/Tunkeutumistestaus2024-bgu248/assets/89390996/7d2341fb-0c94-4695-b833-ab75760146dd)

Kun komennon tuloste ohjeisti minua yhdistämään WebGoatin palvelimelle, yhdistin palvelimelle Firefox -selaimella. Tämän jälkeen loin käyttäjän.

![image](https://github.com/KebabGarva/Tunkeutumistestaus2024-bgu248/assets/89390996/0057fcbb-e4df-4823-9fb7-b00a0cae9175)

![image](https://github.com/KebabGarva/Tunkeutumistestaus2024-bgu248/assets/89390996/37638106-d117-4b62-8f51-ac7d2419cffd)

![image](https://github.com/KebabGarva/Tunkeutumistestaus2024-bgu248/assets/89390996/baabb605-bb60-498e-96a8-4bc569dee8b1)


WebGoat neuvoi kytkemään verkon pois päältä, joten kytkin verkon pois päältä VirtualBox -käyttöliittymän kautta. Oikein-merkin puuttuminen tarkoittaa, että virtuaalikone ei ole yhdistettynä.

![image](https://github.com/KebabGarva/Tunkeutumistestaus2024-bgu248/assets/89390996/bdd1da73-2938-4b32-8494-1963d2a2bb63)





<details>

<summary>HTTP Basics</summary>

### HTTP Basics

</details>

<details>

<summary>Developer Tools</summary>

</details>

## SQL-injektioharjoitus



## Linuxin asennus VirtualBoxiin ja Vagrantiin liittäminen



## Noin 1000:n tyypillisen TCP-portin skannaus



## Kaikkien TCP-porttien skannaus



## Laaja porttiskannaus



## Porttiskannauksien tuloksien ero eri daemonien olevan aktiivisia

<details>

<summary>Apache 2</summary>

### Apache2

</details>

<details>

<summary>SSH</summary>

### SSH

</details>

## Shodan



## Lisätehtävien tekemistä



## Lähteet lämmittelytehtävästä eteenpäin

Surveying Essential Tools for Active Reconnaissance: https://www.oreilly.com/videos/the-art-of/9780135767849/9780135767849-SPTT_04_00/

Intelligence-Driven Computer Network Defense Informed by Analysis of Adversary Campaigns and Intrusion Kill Chains: https://lockheedmartin.com/content/dam/lockheed-martin/rms/documents/cyber/LM-White-Paper-Intel-Driven-Defense.pdf

OverTheWire: Bandit: https://overthewire.org/wargames/bandit/

WebGoatin asennusohje: https://terokarvinen.com/2023/webgoat-2023-4-ethical-web-hacking/

Kalin valmis virtuaalikone: https://www.kali.org/get-kali/#kali-virtual-machines

Shodan: https://www.shodan.io/


